<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>shell | Moyuduo's Blog</title><meta name=keywords content><meta name=description content="申明 在shell脚本中，第一行写#!/bin/bash申请使用bash执行该脚本，当使用./执行脚本文件时就会使用第一行申明的执行器执行，如果使用sh/bash/source/.执行脚本，那么文件申不申明#!/bin/bash都无所谓
执行方式 加可执行权限执行：会解析到文件第一行申明的执行器，使用该执行器开启子shell执行脚本 sh/bash执行：会使用指定的shell执行器开启子shell执行脚本 source/.执行：会使用当前的shell(终端登录的shell)执行脚本，可以避免父子shell变量作用域问题 环境变量 全局环境变量：在当前shell以及子shell中都能够访问的环境变量 局部环境变量：仅在当前shell中可以访问的环境变量，子shell不可访问 env\printenv查看所有全局环境变量
[root@centos72 shell_t]# env XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= [root@centos72 shell_t]# printenv XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= printenv HOME /root 常用全局环境变量：$HOME $PWD $SHELL $USER
set查看当前shell的所有环境变量(全局环境变量和局部环境变量)
定义变量 定义局部变量 a=1 #等号前后不能有空格 b=&#34;hello world&#34; #变量的值不能用空格，如果用空格用引号 定义全局变量 a=1 export a #导出局部变量为全局环境变量 export b=&#34;hello world&#34; #直接申明为全局环境变量 在子shell中定义全局变量/修改父shell中的全局环境变量对父shell来说都是不可见的
由于source/.执行脚本时都是在当前shell中执行，所以在脚本中导出的全局环境变量对当前终端是可见的，所以我们经常使用source /etc/profile导出全局环境变量，而不是sh /etc/profile
一般局部环境变量用小写，全局环境变量用大写
定义只读变量 # readonly定义只读变量,只读变量不可撤销 readonly pi=3.14 unset pi -bash: unset: pi: cannot unset: readonly variable 撤销变量 a=1 echo $a unset a echo $a 变量使用 使用$号取值: echo $a 使用${变量名}取值: echo ${a}_${b}_${c} a=1 b=2 c=3 echo $a_$b_$c #输出 3 3 echo ${a}_${b}_${c} #输出 1_2_3 1_2_3 特殊变量 特殊变量用于向脚本中传入参数"><meta name=author content="Me"><link rel=canonical href=https://moyuduo.github.io/posts/shell/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://moyuduo.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://moyuduo.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://moyuduo.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://moyuduo.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://moyuduo.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="shell"><meta property="og:description" content="申明 在shell脚本中，第一行写#!/bin/bash申请使用bash执行该脚本，当使用./执行脚本文件时就会使用第一行申明的执行器执行，如果使用sh/bash/source/.执行脚本，那么文件申不申明#!/bin/bash都无所谓
执行方式 加可执行权限执行：会解析到文件第一行申明的执行器，使用该执行器开启子shell执行脚本 sh/bash执行：会使用指定的shell执行器开启子shell执行脚本 source/.执行：会使用当前的shell(终端登录的shell)执行脚本，可以避免父子shell变量作用域问题 环境变量 全局环境变量：在当前shell以及子shell中都能够访问的环境变量 局部环境变量：仅在当前shell中可以访问的环境变量，子shell不可访问 env\printenv查看所有全局环境变量
[root@centos72 shell_t]# env XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= [root@centos72 shell_t]# printenv XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= printenv HOME /root 常用全局环境变量：$HOME $PWD $SHELL $USER
set查看当前shell的所有环境变量(全局环境变量和局部环境变量)
定义变量 定义局部变量 a=1 #等号前后不能有空格 b=&#34;hello world&#34; #变量的值不能用空格，如果用空格用引号 定义全局变量 a=1 export a #导出局部变量为全局环境变量 export b=&#34;hello world&#34; #直接申明为全局环境变量 在子shell中定义全局变量/修改父shell中的全局环境变量对父shell来说都是不可见的
由于source/.执行脚本时都是在当前shell中执行，所以在脚本中导出的全局环境变量对当前终端是可见的，所以我们经常使用source /etc/profile导出全局环境变量，而不是sh /etc/profile
一般局部环境变量用小写，全局环境变量用大写
定义只读变量 # readonly定义只读变量,只读变量不可撤销 readonly pi=3.14 unset pi -bash: unset: pi: cannot unset: readonly variable 撤销变量 a=1 echo $a unset a echo $a 变量使用 使用$号取值: echo $a 使用${变量名}取值: echo ${a}_${b}_${c} a=1 b=2 c=3 echo $a_$b_$c #输出 3 3 echo ${a}_${b}_${c} #输出 1_2_3 1_2_3 特殊变量 特殊变量用于向脚本中传入参数"><meta property="og:type" content="article"><meta property="og:url" content="https://moyuduo.github.io/posts/shell/"><meta property="og:image" content="https://moyuduo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-27T16:16:14+08:00"><meta property="article:modified_time" content="2022-11-27T16:16:14+08:00"><meta property="og:site_name" content="Moyuduo's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://moyuduo.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="shell"><meta name=twitter:description content="申明 在shell脚本中，第一行写#!/bin/bash申请使用bash执行该脚本，当使用./执行脚本文件时就会使用第一行申明的执行器执行，如果使用sh/bash/source/.执行脚本，那么文件申不申明#!/bin/bash都无所谓
执行方式 加可执行权限执行：会解析到文件第一行申明的执行器，使用该执行器开启子shell执行脚本 sh/bash执行：会使用指定的shell执行器开启子shell执行脚本 source/.执行：会使用当前的shell(终端登录的shell)执行脚本，可以避免父子shell变量作用域问题 环境变量 全局环境变量：在当前shell以及子shell中都能够访问的环境变量 局部环境变量：仅在当前shell中可以访问的环境变量，子shell不可访问 env\printenv查看所有全局环境变量
[root@centos72 shell_t]# env XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= [root@centos72 shell_t]# printenv XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= printenv HOME /root 常用全局环境变量：$HOME $PWD $SHELL $USER
set查看当前shell的所有环境变量(全局环境变量和局部环境变量)
定义变量 定义局部变量 a=1 #等号前后不能有空格 b=&#34;hello world&#34; #变量的值不能用空格，如果用空格用引号 定义全局变量 a=1 export a #导出局部变量为全局环境变量 export b=&#34;hello world&#34; #直接申明为全局环境变量 在子shell中定义全局变量/修改父shell中的全局环境变量对父shell来说都是不可见的
由于source/.执行脚本时都是在当前shell中执行，所以在脚本中导出的全局环境变量对当前终端是可见的，所以我们经常使用source /etc/profile导出全局环境变量，而不是sh /etc/profile
一般局部环境变量用小写，全局环境变量用大写
定义只读变量 # readonly定义只读变量,只读变量不可撤销 readonly pi=3.14 unset pi -bash: unset: pi: cannot unset: readonly variable 撤销变量 a=1 echo $a unset a echo $a 变量使用 使用$号取值: echo $a 使用${变量名}取值: echo ${a}_${b}_${c} a=1 b=2 c=3 echo $a_$b_$c #输出 3 3 echo ${a}_${b}_${c} #输出 1_2_3 1_2_3 特殊变量 特殊变量用于向脚本中传入参数"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://moyuduo.github.io/posts/"},{"@type":"ListItem","position":2,"name":"shell","item":"https://moyuduo.github.io/posts/shell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"shell","name":"shell","description":"申明 在shell脚本中，第一行写#!/bin/bash申请使用bash执行该脚本，当使用./执行脚本文件时就会使用第一行申明的执行器执行，如果使用sh/bash/source/.执行脚本，那么文件申不申明#!/bin/bash都无所谓\n执行方式 加可执行权限执行：会解析到文件第一行申明的执行器，使用该执行器开启子shell执行脚本 sh/bash执行：会使用指定的shell执行器开启子shell执行脚本 source/.执行：会使用当前的shell(终端登录的shell)执行脚本，可以避免父子shell变量作用域问题 环境变量 全局环境变量：在当前shell以及子shell中都能够访问的环境变量 局部环境变量：仅在当前shell中可以访问的环境变量，子shell不可访问 env\\printenv查看所有全局环境变量\n[root@centos72 shell_t]# env XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= [root@centos72 shell_t]# printenv XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= printenv HOME /root 常用全局环境变量：$HOME $PWD $SHELL $USER\nset查看当前shell的所有环境变量(全局环境变量和局部环境变量)\n定义变量 定义局部变量 a=1 #等号前后不能有空格 b=\u0026#34;hello world\u0026#34; #变量的值不能用空格，如果用空格用引号 定义全局变量 a=1 export a #导出局部变量为全局环境变量 export b=\u0026#34;hello world\u0026#34; #直接申明为全局环境变量 在子shell中定义全局变量/修改父shell中的全局环境变量对父shell来说都是不可见的\n由于source/.执行脚本时都是在当前shell中执行，所以在脚本中导出的全局环境变量对当前终端是可见的，所以我们经常使用source /etc/profile导出全局环境变量，而不是sh /etc/profile\n一般局部环境变量用小写，全局环境变量用大写\n定义只读变量 # readonly定义只读变量,只读变量不可撤销 readonly pi=3.14 unset pi -bash: unset: pi: cannot unset: readonly variable 撤销变量 a=1 echo $a unset a echo $a 变量使用 使用$号取值: echo $a 使用${变量名}取值: echo ${a}_${b}_${c} a=1 b=2 c=3 echo $a_$b_$c #输出 3 3 echo ${a}_${b}_${c} #输出 1_2_3 1_2_3 特殊变量 特殊变量用于向脚本中传入参数","keywords":[],"articleBody":"申明 在shell脚本中，第一行写#!/bin/bash申请使用bash执行该脚本，当使用./执行脚本文件时就会使用第一行申明的执行器执行，如果使用sh/bash/source/.执行脚本，那么文件申不申明#!/bin/bash都无所谓\n执行方式 加可执行权限执行：会解析到文件第一行申明的执行器，使用该执行器开启子shell执行脚本 sh/bash执行：会使用指定的shell执行器开启子shell执行脚本 source/.执行：会使用当前的shell(终端登录的shell)执行脚本，可以避免父子shell变量作用域问题 环境变量 全局环境变量：在当前shell以及子shell中都能够访问的环境变量 局部环境变量：仅在当前shell中可以访问的环境变量，子shell不可访问 env\\printenv查看所有全局环境变量\n[root@centos72 shell_t]# env XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= [root@centos72 shell_t]# printenv XDG_SESSION_ID=1 HOSTNAME=centos72 SELINUX_ROLE_REQUESTED= printenv HOME /root 常用全局环境变量：$HOME $PWD $SHELL $USER\nset查看当前shell的所有环境变量(全局环境变量和局部环境变量)\n定义变量 定义局部变量 a=1 #等号前后不能有空格 b=\"hello world\" #变量的值不能用空格，如果用空格用引号 定义全局变量 a=1 export a #导出局部变量为全局环境变量 export b=\"hello world\" #直接申明为全局环境变量 在子shell中定义全局变量/修改父shell中的全局环境变量对父shell来说都是不可见的\n由于source/.执行脚本时都是在当前shell中执行，所以在脚本中导出的全局环境变量对当前终端是可见的，所以我们经常使用source /etc/profile导出全局环境变量，而不是sh /etc/profile\n一般局部环境变量用小写，全局环境变量用大写\n定义只读变量 # readonly定义只读变量,只读变量不可撤销 readonly pi=3.14 unset pi -bash: unset: pi: cannot unset: readonly variable 撤销变量 a=1 echo $a unset a echo $a 变量使用 使用$号取值: echo $a 使用${变量名}取值: echo ${a}_${b}_${c} a=1 b=2 c=3 echo $a_$b_$c #输出 3 3 echo ${a}_${b}_${c} #输出 1_2_3 1_2_3 特殊变量 特殊变量用于向脚本中传入参数\ncat \u003c arg.sh #!/bin/bash echo $0 #脚本名称 echo $1 #执行脚本传递的第一个参数 echo $2 echo $3 echo \"print input args number:\" echo $# #输入参数个数 echo \"print doller@:\" echo $@ #所有传递参数的列表 echo \"print doller*:\" echo $* #所有传递参数的列表 echo \"traverse doller@:\" for arg in $@ do echo $arg done echo \"traverse doller*:\" for arg in $* do echo $arg done echo \"traverse 'doller@':\" for arg in \"$@\" do echo $arg done echo \"traverse 'doller*':\" for arg in \"$*\" do echo $arg done EOF sh arg.sh 1 2 3 输出： arg.sh 1 2 3 print input args number: 3 print doller@: 1 2 3 print doller*: 1 2 3 traverse doller@: #在不加引号时，$@和$@遍历的结果一样 1 2 3 traverse doller*: 1 2 3 traverse 'doller@': #加了引号以后,$@能遍历出每个参数，$*把所有参数当做一个整体 1 2 3 traverse 'doller*': 1 2 3 echo $? # $? 表示上一条命令的返回状态，返回值是0-255的数，一般0表示执行成功，非0表示出错 运算符 expre expr是linux的一个命令，接受参数并对他们进行计算\nexpr 1 + 2 expr 1 \\* 2 $+双大括号 a=$((1+2)) echo $a $+中括号 a=$[1+2] echo $a b=2 c=3 d=$[$b+$c] #中括号内也可以隔空格 echo $d 反引号 a=`expr 1 + 2` echo $a 条件判断 test test命令用于判断条件是否为真，为真返回0,为假返回1\na=hello test $a=hello echo $a #0 a=Hello test $a = hello echo $a #1 中括号 [ cond ]进行条件判断，中括号前后必须要有空格\na=hello [ $a = hello ] echo $? #0 a=Hello [ $a=Hello ] #报错，等号前后要有空格 [ $a ] echo $a #0 a= #赋空字符串 [ $a ] echo $a #1 整数比较符 -eq -ne -lt -le -gt -ge 文件比较符 -e:文件是否存在 -d:判断文件夹是否存在 -f:判断文件是否存在并且未普通文件 -r:文件是否可读 -w:文件是否可写 -x:文件是否可执行 多条件判断 [ hello ] \u0026\u0026 echo ok || echo notok [ ] \u0026\u0026 echo ok || echo notok num=10 [ $num -ge 10 ] \u0026\u0026 echo \"$num \u003e= 10\" || echo \"$num \u003c 10\" if if [ 条件判断式 ];then fi if [ cond ] then fi if [ cond ] then elif [ cond ] then fi if (( cond )) #cond可以使用 \u003e \u003e= \u003c \u003c= ==等运算符 then fi 四种等效的写法：\ncat \u003c test.sh a=$1 b=$2 if [ $a -ge 10 ] \u0026\u0026 [ $b -ge 10 ] then echo \"a \u003e 10 \u0026\u0026 b \u003e 10\" else echo \"a, b at least one less than 10\" fi EOF cat \u003c test.sh a=$1 b=$2 if [ $a -ge 10 -a $b -ge 10 ] then echo \"a \u003e 10 \u0026\u0026 b \u003e 10\" else echo \"a, b at least one less than 10\" fi EOF cat \u003c test.sh a=$1 b=$2 if [[ $a -ge 10 \u0026\u0026 $b -ge 10 ]] then echo \"a \u003e 10 \u0026\u0026 b \u003e 10\" else echo \"a, b at least one less than 10\" fi EOF cat \u003c test.sh a=$1 b=$2 if (( $a \u003e= 10 \u0026\u0026 $b \u003e= 10 )) then echo \"a \u003e= 10 \u0026\u0026 b \u003e= 10\" else echo \"a, b at least one less than 10\" fi EOF 下面四种写法等效：\ncat \u003c test.sh if [ $1 -lt 10 ];then echo \"a \u003c 10\" elif [ $1 -lt 20 ];then echo \"10 \u003c= a \u003c 20\" else echo \" a \u003e= 20\" fi EOF cat \u003c test.sh if [ $1 -lt 10 ] then echo \"a \u003c 10\" elif [ $1 -lt 20 ] then echo \"10 \u003c= a \u003c 20\" else echo \" a \u003e= 20\" fi EOF cat \u003c test.sh if [ $1 -lt 10 ];then echo \"a \u003c 10\" elif [ $1 -lt 20 ] then echo \"10 \u003c= a \u003c 20\" else echo \" a \u003e= 20\" fi EOF cat \u003c test.sh if (( $1 \u003c 10 ));then echo \"a \u003c 10\" elif (( $1 \u003c 20 )) then echo \"10 \u003c= a \u003c 20\" else echo \"a \u003e= 20\" fi EOF case case $arg_name in \"val1\") block1 ;; \"val2\") block2 ;; *) block3 esac cat \u003c test.sh case $1 in 1) echo \"input 1\" ;; \"abc\") echo \"input abc\" ;; *) echo \"input other\" esac EOF for 1. for加双大括号 for (( 初始值; 循环控制条件; 变量变化 )) do ... done 2. for in for 变量 in 变量1 变量2 变量3 do ... done cat \u003c test.sh for e in 1 2 3 do echo \"e is $e\" done EOF cat \u003c test.sh for e in {1..3} do echo \"e is $e\" done EOF for e in $* 或 for e in $@ 没有区别 for e in \"$*\" 加了引号之后把所有参数当做一个整体 for e in \"$@\" 加了引号之后每个元素任然是单个参数 while while [ cond ] do done while (( cond )) do done read read命令读取控制台输入\n-p 参数指定提示信息 -t 参数指定等待退出时间 cat \u003c test.sh read -t 5 -p \"input a number:\" num echo \"your input is $num\" EOF 函数 系统函数 basename获取指定路径去除后缀的文件名\nbasename ./test.sh =\u003e test.sh basename ./test.sh .sh =\u003e test dirname获取路径的文件夹\ndirname ./test.sh =\u003e . dirname /root/test.sh =\u003e /root 自定义函数 [function] funcname(){ ... [return 0-255] } #申明函数无需指定参数，在函数内部可以通过 $0 $1 ... 来获取传入的参数，$0 为函数名 cat \u003c test.sh myfunc1(){ echo \"$0 $1 $2\" } myfunc1(1, 2) EOF 在shell函数中由于return语句只能返回0-255之间的数，所以像add这样的方法的返回值都无法用return返回\ncat \u003c test.sh add(){ return $[ $1 + $2 ] } add $1 $2 echo $? EOF sh test.sh 1 2 3 sh test.sh 100 200 44 #不正确 改为 cat \u003c test.sh add(){ echo $[ $1 + $2 ] } ret=$(add $1 $2) echo $ret EOF sh test.sh 1 2 3 sh test.sh 100 200 300 cat \u003c test.sh myfunc(){ echo $[ $1 + $2 ] $[ $1 - $2 ] } ret=$(myfunc $1 $2) echo \"===$ret===\" EOF sh test.sh 1 2 ===3 -1=== #会把输出当成一个整体 cat \u003c test.sh myfunc(){ addRet=$[ $1 + $2 ] #也可在函数内部把要返回在值赋值给一个变量，在函数调用后，直接从该变量取值 subRet=$[ $1 - $2 ] } myfunc 1 2 echo $addRet echo $subRet EOF sh test.sh 1 2 3 -1 备份文件案列 #!/bin/bash if [ $# -ne 2 ] then echo \"plz input a file to backup.\" exit fi if [ ! -d $2 ] then mkdir -p $2 fi file_name=$(basename $1) file_path=$(dirname $1) cd $file_path file_path=$(pwd) echo \"file path: $file_path file name: $file_name\" backup_src=\"$file_path/$file_name\" backup_path=$(dirname $2) cd $backup_path backup_path=\"$(pwd)/$(basename $2)\" echo \"backup path: $backup_path\" date_time=$(date +%s) backup_dst=\"$backup_path/${file_name}_${date_time}_archive.tar.gz\" echo \"backup file name: $backup_dst\" exit cd $file_path tar -zcf $backup_dst $file_name if [ $? -eq 0 ] then echo \"backup success, write to $backup_dst\" else echo \"backup failed\" fi 把该脚本加入到crontab中自动执行\ncrontab -e 添加 * * * * * sh /root/shell_t/test.sh /root/shell_t /root/backup2 # 第一个*表示分钟 # 第二个*表示小时 # 第三个*表示一个月的第几天 # 第四个*表示第几个月 # 第五个*表示星期几 或者直接编辑 /root/spool/cron/root 文件，添加以上内容\n要停止任务可以crontab -e删除执行的任务，或者直接vi /var/spool/cron/root删除\n正则 标准正则 匹配开头\n[root@centos72 shell_t]# cat /etc/passwd |grep ^a adm:x:3:4:adm:/var/adm:/sbin/nologin 匹配结尾\n[root@centos72 shell_t]# cat /etc/passwd |grep n$ bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin . 号,匹配任意一个字符\n[root@centos72 shell_t]# cat /etc/passwd |grep r..t root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin * 号，不单独使用，表示匹配*号之前的字符0次或多次\n#ro*t 匹配 rot root roooot [root@centos72 shell_t]# cat /etc/passwd |grep ro*t root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin .* 匹配任意一个字符任意次，即匹配任意字符串\n[root@centos72 shell_t]# cat /etc/passwd |grep r.*t root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin [] 匹配字符区间\n[6,8] 匹配6或者8 [0-9] 匹配0-9的任意数字 [^0-9] 匹配任意非数字字符 [0-9]* 匹配任意数字串 [a-z] 匹配a-z的字符 [a-Z] 匹配a-Z的任意字符 [root@centos72 shell_t]# cat /etc/passwd |grep r[a-z]*t root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin rabbitmq:x:997:995:RabbitMQ messaging server:/var/lib/rabbitmq:/bin/bash gitlab-prometheus:x:992:989::/var/opt/gitlab/prometheus:/bin/sh dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin \\转义\n#匹配$ grep \\$ test.sh 扩展正则 {}指定前一个字符出现几次\n{n}这种写法是扩展正则，grep使用扩展正则需要加 -E 参数 [root@centos72 shell_t]# grep -E ro{2}t /etc/passwd root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin #{n,}匹配前一个字符至少n次 [root@centos72 shell_t]# grep -E \"ro{0,}t\" /etc/passwd root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin #{,n}匹配前一个字符至多n次 [root@centos72 shell_t]# grep -E \"ro{,2}t\" /etc/passwd root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin {n,m}匹配前一个字符n到m次 [root@centos72 shell_t]# grep -E \"ro{1,2}t\" /etc/passwd root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin +号匹配前一个字符一次及以上\ncat \u003c\u003c EOF | grep -E \"go+\" g go goo goole EOF go goo goole ?号匹配前一个字符0次或一次\ncat \u003c\u003c EOF | grep -E \"go?\" g go goo goole EOF g #匹配到g go #匹配到go goo #匹配到go goole #匹配到go 匹配13开头的手机号码\ngrep -E \"13[0-9]{9}\" phone.txt cat cat命令用来查看一个文件的内容\ncat test.sh cat命令配合EOF加输出重定向可以向文件中写入内容\ncat \u003c test.sh name=\"tom\" echo \"hello,\\${name}!\" #在EOF中使用$需要加\\转移 EOF cat test.sh name=\"tom\" echo \"hello, ${name}!\" cut cut命令用于获取文件指定的列，并输出到标准输出\n#-d指定分隔符 -f指定列 cat \u003c","wordCount":"2163","inLanguage":"en","datePublished":"2022-11-27T16:16:14+08:00","dateModified":"2022-11-27T16:16:14+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://moyuduo.github.io/posts/shell/"},"publisher":{"@type":"Organization","name":"Moyuduo's Blog","logo":{"@type":"ImageObject","url":"https://moyuduo.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://moyuduo.github.io/ accesskey=h title="Moyuduo's Blog (Alt + H)"><img src=https://moyuduo.github.io/apple-touch-icon.png alt aria-label=logo height=35>Moyuduo's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://moyuduo.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://moyuduo.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://moyuduo.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://moyuduo.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>shell</h1></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#定义变量>定义变量</a><ul><li><a href=#定义局部变量>定义局部变量</a></li><li><a href=#定义全局变量>定义全局变量</a></li><li><a href=#定义只读变量>定义只读变量</a></li><li><a href=#撤销变量>撤销变量</a></li><li><a href=#变量使用>变量使用</a></li></ul></li></ul><ul><li><a href=#expre>expre</a></li><li><a href=#双大括号>$+双大括号</a></li><li><a href=#中括号>$+中括号</a></li><li><a href=#反引号>反引号</a></li></ul><ul><li><a href=#test>test</a></li><li><a href=#中括号-1>中括号</a></li><li><a href=#整数比较符>整数比较符</a></li><li><a href=#文件比较符>文件比较符</a></li><li><a href=#多条件判断>多条件判断</a></li></ul><ul><li><a href=#系统函数>系统函数</a></li><li><a href=#自定义函数>自定义函数</a></li></ul><ul><li><a href=#标准正则>标准正则</a></li><li><a href=#扩展正则>扩展正则</a></li></ul><ul><li><a href=#-e-参数指定多次编辑可以写多个规则>-e 参数指定多次编辑(可以写多个规则)</a></li><li><a href=#-n-参数指定只输出匹配到的被处理的内容>-n 参数指定只输出匹配到的被处理的内容</a></li><li><a href=#-i-参数指定修改应用到源文件>-i 参数指定修改应用到源文件</a></li><li><a href=#-r-参数指定开启扩展正则>-r 参数指定开启扩展正则</a></li><li><a href=#sed取ip地址>sed取ip地址</a></li></ul></nav></div></details></div><div class=post-content><h1 id=申明>申明<a hidden class=anchor aria-hidden=true href=#申明>#</a></h1><p>在shell脚本中，第一行写<code>#!/bin/bash</code>申请使用bash执行该脚本，当使用<code>./</code>执行脚本文件时就会使用第一行申明的执行器执行，如果使用<code>sh/bash/source/.</code>执行脚本，那么文件申不申明<code>#!/bin/bash</code>都无所谓</p><h1 id=执行方式>执行方式<a hidden class=anchor aria-hidden=true href=#执行方式>#</a></h1><ol><li>加可执行权限执行：会解析到文件第一行申明的执行器，使用该执行器开启子shell执行脚本</li><li><code>sh/bash</code>执行：会使用指定的shell执行器开启子shell执行脚本</li><li><code>source/.</code>执行：会使用当前的shell(终端登录的shell)执行脚本，可以避免父子shell变量作用域问题</li></ol><h1 id=环境变量>环境变量<a hidden class=anchor aria-hidden=true href=#环境变量>#</a></h1><ol><li>全局环境变量：在当前shell以及子shell中都能够访问的环境变量</li><li>局部环境变量：仅在当前shell中可以访问的环境变量，子shell不可访问</li></ol><p><code>env\printenv</code>查看所有全局环境变量</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># env</span>
</span></span><span class=line><span class=cl><span class=nv>XDG_SESSION_ID</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>HOSTNAME</span><span class=o>=</span>centos72
</span></span><span class=line><span class=cl><span class=nv>SELINUX_ROLE_REQUESTED</span><span class=o>=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># printenv</span>
</span></span><span class=line><span class=cl><span class=nv>XDG_SESSION_ID</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>HOSTNAME</span><span class=o>=</span>centos72
</span></span><span class=line><span class=cl><span class=nv>SELINUX_ROLE_REQUESTED</span><span class=o>=</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>printenv HOME
</span></span><span class=line><span class=cl>/root
</span></span></code></pre></div><p>常用全局环境变量：$HOME $PWD $SHELL $USER</p><p><code>set</code>查看当前shell的所有环境变量(全局环境变量和局部环境变量)</p><h2 id=定义变量>定义变量<a hidden class=anchor aria-hidden=true href=#定义变量>#</a></h2><h3 id=定义局部变量>定义局部变量<a hidden class=anchor aria-hidden=true href=#定义局部变量>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span><span class=m>1</span> <span class=c1>#等号前后不能有空格</span>
</span></span><span class=line><span class=cl><span class=nv>b</span><span class=o>=</span><span class=s2>&#34;hello world&#34;</span> <span class=c1>#变量的值不能用空格，如果用空格用引号</span>
</span></span></code></pre></div><h3 id=定义全局变量>定义全局变量<a hidden class=anchor aria-hidden=true href=#定义全局变量>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> a <span class=c1>#导出局部变量为全局环境变量</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>b</span><span class=o>=</span><span class=s2>&#34;hello world&#34;</span>  <span class=c1>#直接申明为全局环境变量</span>
</span></span></code></pre></div><p><strong>在子shell中定义全局变量/修改父shell中的全局环境变量对父shell来说都是不可见的</strong></p><p>由于<code>source/.</code>执行脚本时都是在当前shell中执行，所以在脚本中导出的全局环境变量对当前终端是可见的，所以我们经常使用<code>source /etc/profile</code>导出全局环境变量，而不是<code>sh /etc/profile</code></p><p><strong>一般局部环境变量用小写，全局环境变量用大写</strong></p><h3 id=定义只读变量>定义只读变量<a hidden class=anchor aria-hidden=true href=#定义只读变量>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># readonly定义只读变量,只读变量不可撤销</span>
</span></span><span class=line><span class=cl><span class=nb>readonly</span> <span class=nv>pi</span><span class=o>=</span>3.14
</span></span><span class=line><span class=cl><span class=nb>unset</span> pi
</span></span><span class=line><span class=cl>-bash: unset: pi: cannot unset: <span class=nb>readonly</span> variable
</span></span></code></pre></div><h3 id=撤销变量>撤销变量<a hidden class=anchor aria-hidden=true href=#撤销变量>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span>
</span></span><span class=line><span class=cl><span class=nb>unset</span> a
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span>
</span></span></code></pre></div><h3 id=变量使用>变量使用<a hidden class=anchor aria-hidden=true href=#变量使用>#</a></h3><ol><li>使用<code>$</code>号取值: <code>echo $a</code></li><li>使用<code>${变量名}</code>取值: <code>echo ${a}_${b}_${c}</code></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>b</span><span class=o>=</span><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=nv>c</span><span class=o>=</span><span class=m>3</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a_$b_$c</span> <span class=c1>#输出 3</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=si>${</span><span class=nv>a</span><span class=si>}</span>_<span class=si>${</span><span class=nv>b</span><span class=si>}</span>_<span class=si>${</span><span class=nv>c</span><span class=si>}</span> <span class=c1>#输出 1_2_3</span>
</span></span><span class=line><span class=cl>1_2_3
</span></span></code></pre></div><h1 id=特殊变量>特殊变量<a hidden class=anchor aria-hidden=true href=#特殊变量>#</a></h1><p>特殊变量用于向脚本中传入参数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; arg.sh
</span></span></span><span class=line><span class=cl><span class=s>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo $0 #脚本名称
</span></span></span><span class=line><span class=cl><span class=s>echo $1 #执行脚本传递的第一个参数
</span></span></span><span class=line><span class=cl><span class=s>echo $2 
</span></span></span><span class=line><span class=cl><span class=s>echo $3
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;print input args number:&#34;
</span></span></span><span class=line><span class=cl><span class=s>echo $# #输入参数个数
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;print doller@:&#34;
</span></span></span><span class=line><span class=cl><span class=s>echo $@ #所有传递参数的列表
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;print doller*:&#34;
</span></span></span><span class=line><span class=cl><span class=s>echo $* #所有传递参数的列表
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;traverse doller@:&#34;
</span></span></span><span class=line><span class=cl><span class=s>for arg in $@
</span></span></span><span class=line><span class=cl><span class=s>do
</span></span></span><span class=line><span class=cl><span class=s>    echo $arg
</span></span></span><span class=line><span class=cl><span class=s>done
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;traverse doller*:&#34;
</span></span></span><span class=line><span class=cl><span class=s>for arg in $*
</span></span></span><span class=line><span class=cl><span class=s>do
</span></span></span><span class=line><span class=cl><span class=s>    echo $arg
</span></span></span><span class=line><span class=cl><span class=s>done
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;traverse &#39;doller@&#39;:&#34;
</span></span></span><span class=line><span class=cl><span class=s>for arg in &#34;$@&#34; 
</span></span></span><span class=line><span class=cl><span class=s>do
</span></span></span><span class=line><span class=cl><span class=s>    echo $arg
</span></span></span><span class=line><span class=cl><span class=s>done
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;traverse &#39;doller*&#39;:&#34;
</span></span></span><span class=line><span class=cl><span class=s>for arg in &#34;$*&#34; 
</span></span></span><span class=line><span class=cl><span class=s>do
</span></span></span><span class=line><span class=cl><span class=s>    echo $arg
</span></span></span><span class=line><span class=cl><span class=s>done
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh arg.sh <span class=m>1</span> <span class=m>2</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>输出：
</span></span><span class=line><span class=cl>arg.sh
</span></span><span class=line><span class=cl><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>print input args number:
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>print doller@:
</span></span><span class=line><span class=cl><span class=m>1</span> <span class=m>2</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>print doller*:
</span></span><span class=line><span class=cl><span class=m>1</span> <span class=m>2</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>traverse doller@:   <span class=c1>#在不加引号时，$@和$@遍历的结果一样</span>
</span></span><span class=line><span class=cl><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>traverse doller*:
</span></span><span class=line><span class=cl><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>traverse <span class=s1>&#39;doller@&#39;</span>: <span class=c1>#加了引号以后,$@能遍历出每个参数，$*把所有参数当做一个整体</span>
</span></span><span class=line><span class=cl><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>traverse <span class=s1>&#39;doller*&#39;</span>:
</span></span><span class=line><span class=cl><span class=m>1</span> <span class=m>2</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$?</span> <span class=c1># $? 表示上一条命令的返回状态，返回值是0-255的数，一般0表示执行成功，非0表示出错</span>
</span></span></code></pre></div><h1 id=运算符>运算符<a hidden class=anchor aria-hidden=true href=#运算符>#</a></h1><h2 id=expre>expre<a hidden class=anchor aria-hidden=true href=#expre>#</a></h2><p>expr是linux的一个命令，接受参数并对他们进行计算</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>expr <span class=m>1</span> + <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>expr <span class=m>1</span> <span class=se>\*</span> <span class=m>2</span>
</span></span></code></pre></div><h2 id=双大括号>$+双大括号<a hidden class=anchor aria-hidden=true href=#双大括号>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span><span class=k>$((</span><span class=m>1</span><span class=o>+</span><span class=m>2</span><span class=k>))</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span>
</span></span></code></pre></div><h2 id=中括号>$+中括号<a hidden class=anchor aria-hidden=true href=#中括号>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span>$<span class=o>[</span>1+2<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>b</span><span class=o>=</span><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=nv>c</span><span class=o>=</span><span class=m>3</span>
</span></span><span class=line><span class=cl><span class=nv>d</span><span class=o>=</span>$<span class=o>[</span><span class=nv>$b</span>+<span class=nv>$c</span><span class=o>]</span> <span class=c1>#中括号内也可以隔空格</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$d</span>
</span></span></code></pre></div><h2 id=反引号>反引号<a hidden class=anchor aria-hidden=true href=#反引号>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span><span class=sb>`</span>expr <span class=m>1</span> + 2<span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span>
</span></span></code></pre></div><h1 id=条件判断>条件判断<a hidden class=anchor aria-hidden=true href=#条件判断>#</a></h1><h2 id=test>test<a hidden class=anchor aria-hidden=true href=#test>#</a></h2><p>test命令用于判断条件是否为真，为真返回0,为假返回1</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span>hello
</span></span><span class=line><span class=cl><span class=nb>test</span> <span class=nv>$a</span><span class=o>=</span>hello
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span> <span class=c1>#0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span>Hello
</span></span><span class=line><span class=cl><span class=nb>test</span> <span class=nv>$a</span> <span class=o>=</span> hello
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span> <span class=c1>#1</span>
</span></span></code></pre></div><h2 id=中括号-1>中括号<a hidden class=anchor aria-hidden=true href=#中括号-1>#</a></h2><p><code>[ cond ]</code>进行条件判断，<strong>中括号前后必须要有空格</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span>hello
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$a</span> <span class=o>=</span> hello <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$?</span> <span class=c1>#0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span>Hello
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$a</span><span class=o>=</span>Hello <span class=o>]</span> <span class=c1>#报错，等号前后要有空格</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$a</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span> <span class=c1>#0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>a</span><span class=o>=</span>  <span class=c1>#赋空字符串</span>
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$a</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$a</span> <span class=c1>#1</span>
</span></span></code></pre></div><h2 id=整数比较符>整数比较符<a hidden class=anchor aria-hidden=true href=#整数比较符>#</a></h2><ol><li>-eq</li><li>-ne</li><li>-lt</li><li>-le</li><li>-gt</li><li>-ge</li></ol><h2 id=文件比较符>文件比较符<a hidden class=anchor aria-hidden=true href=#文件比较符>#</a></h2><ol><li>-e:文件是否存在</li><li>-d:判断文件夹是否存在</li><li>-f:判断文件是否存在并且未普通文件</li><li>-r:文件是否可读</li><li>-w:文件是否可写</li><li>-x:文件是否可执行</li></ol><h2 id=多条件判断>多条件判断<a hidden class=anchor aria-hidden=true href=#多条件判断>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span> hello <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> ok <span class=o>||</span> <span class=nb>echo</span> notok
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> ok <span class=o>||</span> <span class=nb>echo</span> notok
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>num</span><span class=o>=</span><span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span> <span class=nv>$num</span> -ge <span class=m>10</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$num</span><span class=s2> &gt;= 10&#34;</span> <span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$num</span><span class=s2> &lt; 10&#34;</span>
</span></span></code></pre></div><h1 id=if>if<a hidden class=anchor aria-hidden=true href=#if>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> 条件判断式 <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> cond <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> cond <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>elif</span> <span class=o>[</span> cond <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>((</span> cond <span class=o>))</span> <span class=c1>#cond可以使用 &gt; &gt;= &lt; &lt;= ==等运算符</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><p>四种等效的写法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>a=$1
</span></span></span><span class=line><span class=cl><span class=s>b=$2
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>if [ $a -ge 10 ] &amp;&amp; [ $b -ge 10 ]
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a &gt; 10 &amp;&amp; b &gt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a, b at least one less than 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>a=$1
</span></span></span><span class=line><span class=cl><span class=s>b=$2
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>if [ $a -ge 10 -a $b -ge 10 ]
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a &gt; 10 &amp;&amp; b &gt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a, b at least one less than 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>a=$1
</span></span></span><span class=line><span class=cl><span class=s>b=$2
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>if [[ $a -ge 10 &amp;&amp; $b -ge 10 ]]
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a &gt; 10 &amp;&amp; b &gt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a, b at least one less than 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>a=$1
</span></span></span><span class=line><span class=cl><span class=s>b=$2
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>if (( $a &gt;= 10 &amp;&amp; $b &gt;= 10 ))
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a &gt;= 10 &amp;&amp; b &gt;= 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;a, b at least one less than 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><p>下面四种写法等效：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>if [ $1 -lt 10 ];then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;a &lt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>elif [ $1  -lt 20 ];then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;10 &lt;= a &lt; 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34; a &gt;= 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>if [ $1 -lt 10 ]
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;a &lt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>elif [ $1  -lt 20 ]
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;10 &lt;= a &lt; 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34; a &gt;= 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>if [ $1 -lt 10 ];then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;a &lt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>elif [ $1  -lt 20 ]
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;10 &lt;= a &lt; 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34; a &gt;= 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>if (( $1 &lt; 10 ));then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;a &lt; 10&#34;
</span></span></span><span class=line><span class=cl><span class=s>elif (( $1 &lt; 20 ))
</span></span></span><span class=line><span class=cl><span class=s>then
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;10 &lt;= a &lt; 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>else
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;a &gt;= 20&#34;
</span></span></span><span class=line><span class=cl><span class=s>fi
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><h1 id=case>case<a hidden class=anchor aria-hidden=true href=#case>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>case</span> <span class=nv>$arg_name</span> in
</span></span><span class=line><span class=cl><span class=s2>&#34;val1&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    block1
</span></span><span class=line><span class=cl><span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;val2&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    block2
</span></span><span class=line><span class=cl><span class=p>;;</span>
</span></span><span class=line><span class=cl>*<span class=o>)</span>
</span></span><span class=line><span class=cl>    block3
</span></span><span class=line><span class=cl><span class=k>esac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>case $1 in
</span></span></span><span class=line><span class=cl><span class=s>1)
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;input 1&#34;
</span></span></span><span class=line><span class=cl><span class=s>;;
</span></span></span><span class=line><span class=cl><span class=s>&#34;abc&#34;)
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;input abc&#34;
</span></span></span><span class=line><span class=cl><span class=s>;;
</span></span></span><span class=line><span class=cl><span class=s>*)
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;input other&#34;
</span></span></span><span class=line><span class=cl><span class=s>esac
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><h1 id=for>for<a hidden class=anchor aria-hidden=true href=#for>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>1. for加双大括号
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>((</span> 初始值<span class=p>;</span> 循环控制条件<span class=p>;</span> 变量变化 <span class=o>))</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. <span class=k>for</span> in
</span></span><span class=line><span class=cl><span class=k>for</span> 变量 in 变量1 变量2 变量3
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>for e in 1 2 3
</span></span></span><span class=line><span class=cl><span class=s>do
</span></span></span><span class=line><span class=cl><span class=s>  echo &#34;e is $e&#34;
</span></span></span><span class=line><span class=cl><span class=s>done
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>for e in {1..3}
</span></span></span><span class=line><span class=cl><span class=s>do
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;e is $e&#34;
</span></span></span><span class=line><span class=cl><span class=s>done
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> e in <span class=nv>$*</span> 或 <span class=k>for</span> e in <span class=nv>$@</span> 没有区别
</span></span><span class=line><span class=cl><span class=k>for</span> e in <span class=s2>&#34;</span><span class=nv>$*</span><span class=s2>&#34;</span> 加了引号之后把所有参数当做一个整体
</span></span><span class=line><span class=cl><span class=k>for</span> e in <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span> 加了引号之后每个元素任然是单个参数
</span></span></code></pre></div><h1 id=while>while<a hidden class=anchor aria-hidden=true href=#while>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>while</span> <span class=o>[</span> cond <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=o>((</span> cond <span class=o>))</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><h1 id=read>read<a hidden class=anchor aria-hidden=true href=#read>#</a></h1><p>read命令读取控制台输入</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-p 参数指定提示信息
</span></span><span class=line><span class=cl>-t 参数指定等待退出时间
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>read -t 5 -p &#34;input a number:&#34; num
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;your input is $num&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><h1 id=函数>函数<a hidden class=anchor aria-hidden=true href=#函数>#</a></h1><h2 id=系统函数>系统函数<a hidden class=anchor aria-hidden=true href=#系统函数>#</a></h2><p>basename获取指定路径去除后缀的文件名</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>basename ./test.sh <span class=o>=</span>&gt; test.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>basename ./test.sh .sh <span class=o>=</span>&gt; <span class=nb>test</span>
</span></span></code></pre></div><p>dirname获取路径的文件夹</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dirname ./test.sh <span class=o>=</span>&gt; .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>dirname /root/test.sh <span class=o>=</span>&gt; /root
</span></span></code></pre></div><h2 id=自定义函数>自定义函数<a hidden class=anchor aria-hidden=true href=#自定义函数>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span><span class=k>function</span><span class=o>]</span> funcname<span class=o>(){</span>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    <span class=o>[</span><span class=k>return</span> 0-255<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#申明函数无需指定参数，在函数内部可以通过 $0 $1 ... 来获取传入的参数，$0 为函数名</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>myfunc1(){
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;$0 $1 $2&#34;
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>myfunc1(1, 2)
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><p>在shell函数中由于return语句只能返回0-255之间的数，所以像add这样的方法的返回值都无法用return返回</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>add(){
</span></span></span><span class=line><span class=cl><span class=s>    return $[ $1 + $2 ]
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>add $1 $2
</span></span></span><span class=line><span class=cl><span class=s>echo $?
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh test.sh <span class=m>1</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh test.sh <span class=m>100</span> <span class=m>200</span>
</span></span><span class=line><span class=cl><span class=m>44</span> <span class=c1>#不正确</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>改为
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>add(){
</span></span></span><span class=line><span class=cl><span class=s>    echo $[ $1 + $2 ]
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>ret=$(add $1 $2)
</span></span></span><span class=line><span class=cl><span class=s>echo $ret
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh test.sh <span class=m>1</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh test.sh <span class=m>100</span> <span class=m>200</span>
</span></span><span class=line><span class=cl><span class=m>300</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>myfunc(){
</span></span></span><span class=line><span class=cl><span class=s>    echo $[ $1 + $2 ] $[ $1 - $2 ]
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>ret=$(myfunc $1 $2)
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;===$ret===&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh test.sh <span class=m>1</span> <span class=nv>2</span>
</span></span><span class=line><span class=cl><span class=o>===</span><span class=m>3</span> -1<span class=o>===</span>  <span class=c1>#会把输出当成一个整体</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>myfunc(){
</span></span></span><span class=line><span class=cl><span class=s>    addRet=$[ $1 + $2 ] #也可在函数内部把要返回在值赋值给一个变量，在函数调用后，直接从该变量取值
</span></span></span><span class=line><span class=cl><span class=s>    subRet=$[ $1 - $2 ]
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>myfunc 1 2
</span></span></span><span class=line><span class=cl><span class=s>echo $addRet
</span></span></span><span class=line><span class=cl><span class=s>echo $subRet
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sh test.sh <span class=m>1</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl>-1
</span></span></code></pre></div><h1 id=备份文件案列>备份文件案列<a hidden class=anchor aria-hidden=true href=#备份文件案列>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$#</span> -ne <span class=m>2</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;plz input a file to backup.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -d <span class=nv>$2</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    mkdir -p <span class=nv>$2</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>file_name</span><span class=o>=</span><span class=k>$(</span>basename <span class=nv>$1</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>file_path</span><span class=o>=</span><span class=k>$(</span>dirname <span class=nv>$1</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$file_path</span>
</span></span><span class=line><span class=cl><span class=nv>file_path</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;file path: </span><span class=nv>$file_path</span><span class=s2> file name: </span><span class=nv>$file_name</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>backup_src</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$file_path</span><span class=s2>/</span><span class=nv>$file_name</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>backup_path</span><span class=o>=</span><span class=k>$(</span>dirname <span class=nv>$2</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$backup_path</span>
</span></span><span class=line><span class=cl><span class=nv>backup_path</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span><span class=s2>/</span><span class=k>$(</span>basename <span class=nv>$2</span><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;backup path: </span><span class=nv>$backup_path</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>date_time</span><span class=o>=</span><span class=k>$(</span>date +%s<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>backup_dst</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$backup_path</span><span class=s2>/</span><span class=si>${</span><span class=nv>file_name</span><span class=si>}</span><span class=s2>_</span><span class=si>${</span><span class=nv>date_time</span><span class=si>}</span><span class=s2>_archive.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;backup file name: </span><span class=nv>$backup_dst</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$file_path</span>
</span></span><span class=line><span class=cl>tar -zcf <span class=nv>$backup_dst</span> <span class=nv>$file_name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$?</span> -eq <span class=m>0</span> <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;backup success, write to </span><span class=nv>$backup_dst</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;backup failed&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><p>把该脚本加入到crontab中自动执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>crontab -e
</span></span><span class=line><span class=cl>添加
</span></span><span class=line><span class=cl>* * * * * sh /root/shell_t/test.sh /root/shell_t /root/backup2
</span></span><span class=line><span class=cl><span class=c1># 第一个*表示分钟</span>
</span></span><span class=line><span class=cl><span class=c1># 第二个*表示小时</span>
</span></span><span class=line><span class=cl><span class=c1># 第三个*表示一个月的第几天</span>
</span></span><span class=line><span class=cl><span class=c1># 第四个*表示第几个月</span>
</span></span><span class=line><span class=cl><span class=c1># 第五个*表示星期几</span>
</span></span></code></pre></div><p>或者直接编辑 /root/spool/cron/root 文件，添加以上内容</p><p>要停止任务可以<code>crontab -e</code>删除执行的任务，或者直接<code>vi /var/spool/cron/root</code>删除</p><h1 id=正则>正则<a hidden class=anchor aria-hidden=true href=#正则>#</a></h1><h2 id=标准正则>标准正则<a hidden class=anchor aria-hidden=true href=#标准正则>#</a></h2><p>匹配开头</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd |grep ^a</span>
</span></span><span class=line><span class=cl>adm:x:3:4:adm:/var/adm:/sbin/nologin
</span></span></code></pre></div><p>匹配结尾</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd |grep n$</span>
</span></span><span class=line><span class=cl>bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class=line><span class=cl>daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span></span><span class=line><span class=cl>adm:x:3:4:adm:/var/adm:/sbin/nologin
</span></span></code></pre></div><p>. 号,匹配任意一个字符</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd |grep r..t</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span></code></pre></div><p>* 号，不单独使用，表示匹配*号之前的字符0次或多次</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#ro*t 匹配 rot root roooot</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd |grep ro*t</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span></code></pre></div><p>.* 匹配任意一个字符任意次，即匹配任意字符串</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd |grep r.*t</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
</span></span></code></pre></div><p>[] 匹配字符区间</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>6,8<span class=o>]</span> 匹配6或者8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>0-9<span class=o>]</span> 匹配0-9的任意数字
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>^0-9<span class=o>]</span> 匹配任意非数字字符
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>0-9<span class=o>]</span>* 匹配任意数字串
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>a-z<span class=o>]</span> 匹配a-z的字符
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>a-Z<span class=o>]</span> 匹配a-Z的任意字符
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd |grep r[a-z]*t</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
</span></span><span class=line><span class=cl>rabbitmq:x:997:995:RabbitMQ messaging server:/var/lib/rabbitmq:/bin/bash
</span></span><span class=line><span class=cl>gitlab-prometheus:x:992:989::/var/opt/gitlab/prometheus:/bin/sh
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span></code></pre></div><p>\转义</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#匹配$</span>
</span></span><span class=line><span class=cl>grep <span class=se>\$</span> test.sh
</span></span></code></pre></div><h2 id=扩展正则>扩展正则<a hidden class=anchor aria-hidden=true href=#扩展正则>#</a></h2><p>{}指定前一个字符出现几次</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>n<span class=o>}</span>这种写法是扩展正则，grep使用扩展正则需要加 -E 参数
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># grep -E ro{2}t /etc/passwd</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#{n,}匹配前一个字符至少n次</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># grep -E &#34;ro{0,}t&#34; /etc/passwd</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#{,n}匹配前一个字符至多n次</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># grep -E &#34;ro{,2}t&#34; /etc/passwd</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{</span>n,m<span class=o>}</span>匹配前一个字符n到m次
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># grep -E &#34;ro{1,2}t&#34; /etc/passwd</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>operator:x:11:0:operator:/root:/sbin/nologin
</span></span><span class=line><span class=cl>dockerroot:x:991:988:Docker User:/var/lib/docker:/sbin/nologin
</span></span></code></pre></div><p>+号匹配前一个字符一次及以上</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF | grep -E &#34;go+&#34;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goo
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>goo
</span></span><span class=line><span class=cl>goole
</span></span></code></pre></div><p>?号匹配前一个字符0次或一次</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF | grep -E &#34;go?&#34;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goo
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>g   <span class=c1>#匹配到g</span>
</span></span><span class=line><span class=cl>go  <span class=c1>#匹配到go</span>
</span></span><span class=line><span class=cl>goo <span class=c1>#匹配到go</span>
</span></span><span class=line><span class=cl>goole   <span class=c1>#匹配到go</span>
</span></span></code></pre></div><p>匹配13开头的手机号码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -E <span class=s2>&#34;13[0-9]{9}&#34;</span> phone.txt
</span></span></code></pre></div><h1 id=cat>cat<a hidden class=anchor aria-hidden=true href=#cat>#</a></h1><p>cat命令用来查看一个文件的内容</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat test.sh
</span></span></code></pre></div><p>cat命令配合EOF加输出重定向可以向文件中写入内容</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.sh
</span></span></span><span class=line><span class=cl><span class=s>name=&#34;tom&#34;
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;hello,\${name}!&#34;  #在EOF</span>中使用$需要加<span class=se>\转</span>移
</span></span><span class=line><span class=cl>EOF
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat test.sh
</span></span><span class=line><span class=cl><span class=nv>name</span><span class=o>=</span><span class=s2>&#34;tom&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;hello, </span><span class=si>${</span><span class=nv>name</span><span class=si>}</span><span class=s2>!&#34;</span>
</span></span></code></pre></div><h1 id=cut>cut<a hidden class=anchor aria-hidden=true href=#cut>#</a></h1><p>cut命令用于获取文件指定的列，并输出到标准输出</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#-d指定分隔符 -f指定列</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | cut -d &#34; &#34; -f 1
</span></span></span><span class=line><span class=cl><span class=s>tom man 20
</span></span></span><span class=line><span class=cl><span class=s>jerry female 18
</span></span></span><span class=line><span class=cl><span class=s>jack man 25
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>tom
</span></span><span class=line><span class=cl>jerry
</span></span><span class=line><span class=cl>jack
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | cut -d &#34; &#34; -f 1,2
</span></span></span><span class=line><span class=cl><span class=s>tom man 20
</span></span></span><span class=line><span class=cl><span class=s>jerry female 18
</span></span></span><span class=line><span class=cl><span class=s>jack man 25
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>tom man
</span></span><span class=line><span class=cl>jerry female
</span></span><span class=line><span class=cl>jack man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | cut -d &#34; &#34; -f 1-2
</span></span></span><span class=line><span class=cl><span class=s>tom man 20
</span></span></span><span class=line><span class=cl><span class=s>jerry female 18
</span></span></span><span class=line><span class=cl><span class=s>jack man 25
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>tom man
</span></span><span class=line><span class=cl>jerry female
</span></span><span class=line><span class=cl>jack man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | cut -d &#34; &#34; -f -2
</span></span></span><span class=line><span class=cl><span class=s>tom man 20
</span></span></span><span class=line><span class=cl><span class=s>jerry female 18
</span></span></span><span class=line><span class=cl><span class=s>jack man 25
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>tom man
</span></span><span class=line><span class=cl>jerry female
</span></span><span class=line><span class=cl>jack man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | cut -d &#34; &#34; -f 2-
</span></span></span><span class=line><span class=cl><span class=s>tom man 20
</span></span></span><span class=line><span class=cl><span class=s>jerry female 18
</span></span></span><span class=line><span class=cl><span class=s>jack man 25
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>man <span class=m>20</span>
</span></span><span class=line><span class=cl>female <span class=m>18</span>
</span></span><span class=line><span class=cl>man <span class=m>25</span>
</span></span></code></pre></div><p>获取ip地址</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ifconfig ens33 <span class=p>|</span>grep netmask <span class=p>|</span>cut -d <span class=s2>&#34; &#34;</span> -f <span class=m>10</span>
</span></span><span class=line><span class=cl>192.168.37.131
</span></span></code></pre></div><h1 id=grep>grep<a hidden class=anchor aria-hidden=true href=#grep>#</a></h1><p>grep用于配合正则按行过滤数据</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep &#39;go&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go 
</span></span><span class=line><span class=cl>goole
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -E 指定使用扩展正则</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go  <span class=c1>#匹配到go</span>
</span></span><span class=line><span class=cl>goole   <span class=c1>#匹配到goo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -m 参数指定输出的最大行数</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -m 1 -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -c 参数指定输出匹配到的行数</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -c -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -i 参数指定忽略匹配正则的大小写</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -i -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>Go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>Go
</span></span><span class=line><span class=cl>goole
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -v 参数指定输出匹配到的行以外的行</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -v -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>Go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>g
</span></span><span class=line><span class=cl>Go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -w 参数指定正则要匹配整个单词</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -w -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>Go
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -x 参数指定正则要匹配一整行的内容</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -x -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>go is good
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -o 参数指定只显示匹配到的内容，对于同一行有多个匹配到的内容会隔行显示</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF | grep -o -E &#39;go+&#39;
</span></span></span><span class=line><span class=cl><span class=s>g
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>go is good
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>goo
</span></span><span class=line><span class=cl>goo
</span></span></code></pre></div><h1 id=sed>sed<a hidden class=anchor aria-hidden=true href=#sed>#</a></h1><p>sed针对文件的每一行进行处理，把一行读入放入模式空间，然后对模式空间的数据进行处理(增加/修改/删除)后输出到屏幕，直到处理完文件的每一行,处理完毕后并不会改变源文件，只会把处理后的结果输出到屏幕，改变源文件需要配合输出重定向</p><h2 id=-e-参数指定多次编辑可以写多个规则>-e 参数指定多次编辑(可以写多个规则)<a hidden class=anchor aria-hidden=true href=#-e-参数指定多次编辑可以写多个规则>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.txt
</span></span></span><span class=line><span class=cl><span class=s>line1   name    tom
</span></span></span><span class=line><span class=cl><span class=s>line2   age 20
</span></span></span><span class=line><span class=cl><span class=s>line3   gender  man
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1p&#34;</span> -n test.txt <span class=c1># p参数指定打印行为 -n参数取消默认打印，只输出匹配到的行</span>
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;/name/p&#34;</span> -n test.txt    <span class=c1># 模糊匹配存在name的行</span>
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;/^line2/p&#34;</span> -n test.txt
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1,2p&#34;</span> -n test.txt   <span class=c1># 1,2 指定第一行和第二行</span>
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;2~1p&#34;</span> -n test.txt   <span class=c1># 2~1 指定从第二行开始，已1步长匹配行</span>
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;2~2p&#34;</span> -n test.txt
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;2,+3p&#34;</span> -n test.txt  <span class=c1># 2,+3 表示从第二行开始匹配向下三行(包括本行)</span>
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;2,\$p&#34;</span> -n test.txt  <span class=c1>#   2,\$ 表示匹配从第二行开始一直到结尾的行</span>
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1d&#34;</span> test.txt    <span class=c1># d参数指定删除的行</span>
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1d&#34;</span> -e <span class=s2>&#34;s/age 20/age 30/g&#34;</span> test.txt <span class=c1># s参数指定进行替换，g是全局</span>
</span></span><span class=line><span class=cl>line2   age <span class=m>30</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat test.txt    <span class=c1>#源文件内容没有变</span>
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1a hight 170cm&#34;</span> test.txt    <span class=c1># a参数指定在指定的行后添加一行/多行</span>
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>hight 170cm
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1i weight 55kg&#34;</span> test.txt    <span class=c1># i参数指定在指定的行前插入一行/多行</span>
</span></span><span class=line><span class=cl>weight 55kg
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#输出结果重定向</span>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;1a hight 170cm&#34;</span> test.txt &gt; test.txt
</span></span></code></pre></div><h2 id=-n-参数指定只输出匹配到的被处理的内容>-n 参数指定只输出匹配到的被处理的内容<a hidden class=anchor aria-hidden=true href=#-n-参数指定只输出匹配到的被处理的内容>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sed -e <span class=s2>&#34;1p&#34;</span> -n test.txt <span class=c1># p参数指定打印行为 -n参数取消默认打印，只输出匹配到的行</span>
</span></span><span class=line><span class=cl>line1   name    tom
</span></span></code></pre></div><h2 id=-i-参数指定修改应用到源文件>-i 参数指定修改应用到源文件<a hidden class=anchor aria-hidden=true href=#-i-参数指定修改应用到源文件>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat test.txt
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>line2   age <span class=m>20</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -i -e <span class=s2>&#34;s/age 20/age 30/g&#34;</span> test.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat test.txt
</span></span><span class=line><span class=cl>line1   name    tom
</span></span><span class=line><span class=cl>line2   age <span class=m>30</span>
</span></span><span class=line><span class=cl>line3   gender  man
</span></span></code></pre></div><h2 id=-r-参数指定开启扩展正则>-r 参数指定开启扩展正则<a hidden class=anchor aria-hidden=true href=#-r-参数指定开启扩展正则>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; test.txt
</span></span></span><span class=line><span class=cl><span class=s>go
</span></span></span><span class=line><span class=cl><span class=s>goo
</span></span></span><span class=line><span class=cl><span class=s>goole
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -e <span class=s2>&#34;s/go+/x/g&#34;</span> test.txt <span class=c1># 不加-r参数由于+是扩展正则，所以不能匹配到任何的内容</span>
</span></span><span class=line><span class=cl>go
</span></span><span class=line><span class=cl>goo
</span></span><span class=line><span class=cl>goole
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sed -r -e <span class=s2>&#34;s/go+/x/g&#34;</span> test.txt
</span></span><span class=line><span class=cl>x
</span></span><span class=line><span class=cl>x
</span></span><span class=line><span class=cl>xle
</span></span></code></pre></div><h2 id=sed取ip地址>sed取ip地址<a hidden class=anchor aria-hidden=true href=#sed取ip地址>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ifconfig ens33 <span class=p>|</span> sed <span class=s1>&#39;2p&#39;</span> -n <span class=p>|</span> sed <span class=s2>&#34;s/^.*inet//g&#34;</span> <span class=p>|</span> sed <span class=s2>&#34;s/netmask.*</span>$<span class=s2>//g&#34;</span>
</span></span><span class=line><span class=cl> 192.168.37.131  <span class=c1>#前后有空格</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ifconfig ens33 <span class=p>|</span> sed -e <span class=s2>&#34;2s/^.*inet//&#34;</span> -n -e <span class=s2>&#34;s/netmask.*</span>$<span class=s2>//p&#34;</span> -n 
</span></span><span class=line><span class=cl> 192.168.37.131 
</span></span></code></pre></div><h1 id=awk>awk<a hidden class=anchor aria-hidden=true href=#awk>#</a></h1><p>awk通过正则过滤到匹配的行，然后对行进行切片(默认以空格)，然后对每个切片进行处理</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># -F 参数指定行分隔符</span>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> awk -F <span class=s2>&#34;:&#34;</span> <span class=s1>&#39;/^root/ {print $7}&#39;</span>
</span></span><span class=line><span class=cl>/bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> awk -F <span class=s2>&#34;:&#34;</span> <span class=s1>&#39;/^root/ {print $1 &#34;,&#34; $7}&#39;</span>
</span></span><span class=line><span class=cl>root,/bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BEGIN代码块在过滤之前执行 END代码块在过滤结束之后执行</span>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> awk -F <span class=s2>&#34;:&#34;</span> <span class=s1>&#39;BEGIN{print &#34;start&#34;}{print $1&#34;=&#34;$7}END{print &#34;stop&#34;}&#39;</span>
</span></span><span class=line><span class=cl>start
</span></span><span class=line><span class=cl><span class=nv>root</span><span class=o>=</span>/bin/bash
</span></span><span class=line><span class=cl><span class=nv>bin</span><span class=o>=</span>/sbin/nologin
</span></span><span class=line><span class=cl><span class=nv>daemon</span><span class=o>=</span>/sbin/nologin
</span></span><span class=line><span class=cl>stop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> awk -F <span class=s2>&#34;:&#34;</span> <span class=s1>&#39;{print $3+1}&#39;</span>
</span></span><span class=line><span class=cl><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=m>3</span>
</span></span><span class=line><span class=cl><span class=m>4</span>
</span></span><span class=line><span class=cl><span class=m>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用-v参数可以像awk中的变量赋值</span>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> awk -F <span class=s2>&#34;:&#34;</span> -v <span class=nv>num</span><span class=o>=</span><span class=m>1</span> <span class=s1>&#39;{print $3+num}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 内置变量</span>
</span></span><span class=line><span class=cl><span class=c1># FILENAME 文件名</span>
</span></span><span class=line><span class=cl><span class=c1># NR 行号</span>
</span></span><span class=line><span class=cl><span class=c1># NF 列号</span>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> awk -F <span class=s2>&#34;:&#34;</span> <span class=s1>&#39;{print &#34;filename=&#34;FILENAME, &#34;row_number=&#34;NR, &#34;col_number&#34;NF}&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@centos72 shell_t<span class=o>]</span><span class=c1># cat /etc/passwd | awk -F &#34;:&#34; &#39;{print &#34;filename=&#34;FILENAME, &#34;row_number=&#34;NR, &#34;col_number&#34;NF}&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>filename</span><span class=o>=</span>- <span class=nv>row_number</span><span class=o>=</span><span class=m>1</span> col_number7
</span></span><span class=line><span class=cl><span class=nv>filename</span><span class=o>=</span>- <span class=nv>row_number</span><span class=o>=</span><span class=m>2</span> col_number7
</span></span><span class=line><span class=cl><span class=nv>filename</span><span class=o>=</span>- <span class=nv>row_number</span><span class=o>=</span><span class=m>3</span> col_number7
</span></span></code></pre></div><p>awk截取ip</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ifconfig <span class=p>|</span> awk <span class=s1>&#39;/netmask/ {print $2}&#39;</span>
</span></span><span class=line><span class=cl>172.17.0.1
</span></span><span class=line><span class=cl>192.168.37.131
</span></span><span class=line><span class=cl>127.0.0.1
</span></span></code></pre></div><h1 id=sort>sort<a hidden class=anchor aria-hidden=true href=#sort>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; sort.txt
</span></span></span><span class=line><span class=cl><span class=s>aa:1:tom
</span></span></span><span class=line><span class=cl><span class=s>bb:0:jack
</span></span></span><span class=line><span class=cl><span class=s>dd:5:jarry
</span></span></span><span class=line><span class=cl><span class=s>cc:4:lucy
</span></span></span><span class=line><span class=cl><span class=s>ee:3:mike
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sort sort.txt   <span class=c1>#按照字母序排序</span>
</span></span><span class=line><span class=cl>aa:1:tom
</span></span><span class=line><span class=cl>bb:0:jack
</span></span><span class=line><span class=cl>cc:4:lucy
</span></span><span class=line><span class=cl>dd:5:jarry
</span></span><span class=line><span class=cl>ee:3:mike
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sort -r sort.txt    <span class=c1>#-r指定降序排序</span>
</span></span><span class=line><span class=cl>ee:3:mike
</span></span><span class=line><span class=cl>dd:5:jarry
</span></span><span class=line><span class=cl>cc:4:lucy
</span></span><span class=line><span class=cl>bb:0:jack
</span></span><span class=line><span class=cl>aa:1:tom
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sort -t : -k <span class=m>2</span> sort.txt <span class=c1>#-t指定分隔符   -k指定对哪一列排序</span>
</span></span><span class=line><span class=cl>bb:0:jack
</span></span><span class=line><span class=cl>aa:1:tom
</span></span><span class=line><span class=cl>ee:3:mike
</span></span><span class=line><span class=cl>cc:4:lucy
</span></span><span class=line><span class=cl>dd:5:jarry
</span></span></code></pre></div><h1 id=nohup>nohup<a hidden class=anchor aria-hidden=true href=#nohup>#</a></h1><p>nohup命令将程序以忽略挂起信号的方式后台运行，输出的结果不打印到终端而是保存在当前目录的nohup.out文件中，如果当前目录下的nohup.out文件无法写入会保存到$HOME/nohup.out文件中</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nohup ping baidu.com
</span></span><span class=line><span class=cl>nohup: ignoring input and appending output to ‘nohup.out’   <span class=c1>#进程会hang在这儿，不能执行其他命令，如果ctrl+c结束程序，那么执行的程序也会停止</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nohup ping bilibili.com <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>nohup: ignoring input and appending output to ‘nohup.out’ <span class=c1>#进程会hang在这儿,但是ctrl+c结束结束程序后，执行的程序不会停止</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nohup ping baidu.com &gt; ping.log <span class=p>&amp;</span> <span class=c1># 把程序的标准输出重定向到指定文件</span>
</span></span><span class=line><span class=cl>nohup ping baidu.com &gt;ping.log <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#   标准输出 1  </span>
</span></span><span class=line><span class=cl><span class=c1>#   标准错误输出 2</span>
</span></span><span class=line><span class=cl>nohup ping baidu.com &gt; ping.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span> <span class=c1># 把程序的标准输出及出错信息都写入到指定文件</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nohup ping baidu.com &gt; /dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span> <span class=c1># 把程序的输出写入到linux的黑洞文件立即销毁</span>
</span></span></code></pre></div><p>把程序的标准输出和标准错误输出写入文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 把标准输出写入app.log,标准错误输出写入err.log</span>
</span></span><span class=line><span class=cl>nohup ping baidu.com &gt; ping-app.log 2&gt;ping-err.log <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>nohup ping baidu.com 1&gt;ping-app.log 2&gt;ping-err.log <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 把标准输出标准错误输出都写入app.log文件</span>
</span></span><span class=line><span class=cl>nohup ping baidu.com &gt; app.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>nohup ping baidu.com <span class=p>&amp;</span>&gt;app.log <span class=p>&amp;</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://moyuduo.github.io/>Moyuduo's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>